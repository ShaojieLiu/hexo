---
title: 浅谈面向接口
date: 2019-03-21 00:02:02
tags: 架构
---

> 这个题目是由之前看一些架构方面书籍, 当时很是不懂什么是"面向接口编程", 特别是 SOLID 原则里的依赖倒置原则(Dependence Inversion Principle, DIP), 名字本身就相当拗口. 那么今天就从这个原则出发辅以一些简单的例子来表达我对此的思考.

# 一, 为什么要面向接口?

我们举一些例子来说明为什么要面向接口:

交警小明需要对每一个路过的司机进行驾驶资质验证, 由于"人"的属性很多很复杂, 交警无法知道每一个人是否具有驾驶资质, 因此他需要面向接口. 这个接口就是<驾照>. 他的工作变得很简单, 只要看某个人是否实现了<驾照>这一接口就可以完成工作.
相反, 如果交警不通过抽象<驾照>这一接口, 他的工作就会变得异常痛苦. 他可能需要携带一个色盲图谱和一份视力表, 即使如此花上时间也只能验证驾驶资质的视力资质部分, 其他的资质例如驾驶员是否可以"倒车入库", 那么需要更多工作量.

所以我们明白了, 面向接口这件事情不止是存在与编程之中, 它是广泛存在于现实生活中的. 还是就开车的例子, 为什么你学车的时候只学习了一种厂家型号车辆的驾驶但其他厂家的车辆你也很快可以驾驶? 我们都知道, 他们的很多对外暴露的方法是一致的, 例如左下是刹车右下是油门. 可以这样理解, 汽车厂商在制造汽车的时候都遵循同一个接口规范, 我们可以称之为<车辆操作接口>, 正因为这样不同厂商生产的车尽管实现各不相同(有的是三缸发动机, 有的是纯电动或者混动), 但接口却大同小异, 你在操控使用的过程中就不必关心那些内部细节, 使用便捷.
相反, 如果厂商不遵循接口来实现车辆, 那你可能会面临一些困境, 例如燃油车的刹车在左边, 电动车的刹车在右边, 这样的不一致会带来额外的学习成本并使得驾驶者相当困惑.

以上的两个例子其实也说明了面向接口的两个理由:
1, 使得依赖变得轻量, 接口比类更灵活
2, 使用同一的接口可以屏蔽内部实现的细节, 使得切换的成本降低

到这里聪明的你或许还有些疑问, 例如第一个例子中, 为什么不创建一个类称为"具备驾驶能力者", 然后他 extend 出若干子类, 这时候如果交警得到一个"路过的司机", 他只需要判断该类是否继承自"具备驾驶能力者"即可完成任务. 用程序员行话来说就是交警只需要依赖"驾驶者"父类即可, 这样也可以避免交警依赖多个不同的子类所带来的麻烦.
在我编程的初期, 我也经常使用依赖父类来解决这种问题. 直到我的程序足够复杂, 还用交警的例子, 交警还想判断司机是否酒驾. 用继承的方式, 你会创建一个"酒驾者"的父类, 交警依赖这个父类来进行判断. 但问题是这个路过的司机只能继承自一个父类, 那么你必须用"路过的司机"继承自"酒驾者", "酒驾者"继承自"具备驾驶能力者", 但问题就来了: "酒驾者"不一定是"具备驾驶能力者".

接口与父类相比, 有一个不同: "一个类可以同时实现多个接口, 但只能继承自一个父类". 这种不同导致往往接口比类小巧得多, 因此一个接口可以很灵活, 可以只是某一个功能的抽象, 这样子接口可以更加符合"单一职责"的原则, 因此它被修改的原因会很有限. 另外类可以同时实现多个接口, 这样子也会使得接口更符合"开闭原则", 即是说, 我可以通过新增接口来满足需求, 而不是修改旧的接口.

## 1, DIP 原则的定义

## 2, 面向接口编程的含义

## 3, 面向接口的好处

# 二, 如何面向接口?

## 1, 前端开发如何做到面向接口?

## 2, 其他语言或框架是如何面向接口的?

## 3, 举例说明面向接口的做法和好处

## 4, 什么是过度设计?

# 三, 总结
